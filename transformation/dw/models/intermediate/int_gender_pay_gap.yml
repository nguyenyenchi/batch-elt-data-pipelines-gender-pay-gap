models:
  - name: int_gender_pay_gap
    description: Intermediate model to calculate gender pay gap
    data_tests:
      - dbt_utils.expression_is_true:
          arguments:
            expression: "weekly_earnings_gap = male_weekly_earnings - female_weekly_earnings"
    columns:
      - name: occupation_code
        data_type: varchar
        description: ""

      - name: occupation
        data_type: varchar
        description: ""

      - name: year
        data_type: number
        description: ""

      - name: female_weekly_earnings
        data_type: number
        description: ""

      - name: male_weekly_earnings
        data_type: number
        description: ""

      - name: weekly_earnings_gap
        data_type: number
        description: ""

      - name: weekly_gender_pay_gap_pct
        data_type: number
        description: ""
        data_tests:
          - is_between:
              description: "Pct should be between -1 and 1"
              arguments:
                bottom_number: -1
                top_number: 1